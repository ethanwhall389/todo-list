(()=>{"use strict";class e{constructor(e){this.ventureName=e,this.tasks=[]}}const t=new class{constructor(){this.ventures=[]}setVentures(e){this.ventures=e}getVentures(){return this.ventures}getVentureName(e){return this.ventures[e].ventureName}getTasks(e){return this.ventures[e].tasks}addTask(e,t){this.ventures[e].tasks.push({name:t,checked:!1})}removeTask(e,t){this.ventures[e].tasks.splice(t,1)}findVentureIndex(e){const t=this.ventures;for(let n=0;n<t.length;n++)if(t[n].ventureName===e)return n}addVenture(t){this.ventures.push(new e(t))}removeVenture(e){this.ventures.splice(e,1)}removeChecked(e,t){this.ventures[e].tasks[t].checked=!1}addChecked(e,t){this.ventures[e].tasks[t].checked=!0}},n=document.querySelector("#input-box"),s=document.querySelector("#add-task-bttn"),a=document.querySelector("#list-container"),d=(document.querySelector(".delete-icon"),document.querySelector(".select-box")),r=(document.querySelector(".dynamic-options"),document.querySelector(".modal-container")),c=document.querySelector("#venture-input-box"),o=document.querySelector("#add-venture-bttn"),u=document.querySelector(".delete-venture-bttn"),l=document.querySelector(".error-message-container"),i=document.querySelector(".close-modal-bttn");let v;class m{static loadPage(){localStorage.length>0?(t.setVentures(JSON.parse(localStorage.getItem("ventures"))),m.loadVenture(JSON.parse(localStorage.getItem("selectedVenture")))):(m.addVenture("Demo Venture"),m.addTask("Wash clothes"),m.addTask("Take shower"),m.addTask("Read book"))}static loadTasks(e){const n=t.getTasks(e);if(n.length>=1)for(let e=0;e<n.length;e++){const t=document.createElement("div");t.classList.add("task-row");const s=document.createElement("li");s.textContent=n[e].name,s.setAttribute("task-index",e),!0===n[e].checked&&s.classList.add("checked");const d=document.createElement("img");d.setAttribute("src","./images/delete-task.svg"),d.setAttribute("task-index",e),d.classList.add("delete-icon"),t.append(s,d),a.appendChild(t)}else{const n=document.createElement("p"),s=t.getVentureName(e);n.textContent=`${s} has no tasks`,a.appendChild(n)}}static loadVenture(e){const n=t.findVentureIndex(e);m.updatePage(n),d.value=e,v=e,localStorage.setItem("selectedVenture",JSON.stringify(v))}static updatePage(e){a.textContent="",localStorage.setItem("ventures",JSON.stringify(t.getVentures())),m.loadVentureList(),m.loadTasks(e)}static loadVentureList(){d.textContent="";const e=document.createElement("option");e.value="Create New Venture",e.setAttribute("id","create-venture-option"),e.textContent="+ Create New Venture",d.appendChild(e),t.getVentures().forEach((e=>{const t=e.ventureName,n=document.createElement("option");n.setAttribute("value",t),n.textContent=t,d.appendChild(n)})),d.value=v}static getSelectedVentureIndex(){const e=d.value;return t.findVentureIndex(e)}static addTask(e){const n=m.getSelectedVentureIndex();t.addTask(n,e),m.updatePage(n)}static removeTask(e){const n=m.getSelectedVentureIndex();t.removeTask(n,e),m.updatePage(n)}static addVenture(e){t.addVenture(e),m.loadVenture(e)}static showErrorMessage(e){const t=document.createElement("p");t.textContent=e,l.appendChild(t),setTimeout((function(){t.remove()}),3e3)}static deleteVenture(){const e=m.getSelectedVentureIndex();if(t.getVentures().length>=2){t.removeVenture(e);const n=t.getVentures(),s=n[n.length-1].ventureName;m.loadVenture(s)}else m.showErrorMessage("You must have at least one venture")}static displayModal(){r.style.display="block"}static hideModal(){r.style.display="none",n.focus()}}function k(){""!==n.value&&(m.addTask(n.value),n.value="",n.focus())}s.addEventListener("click",(()=>{k()})),a.addEventListener("click",(e=>{if(e.target.classList.contains("delete-icon")){const t=e.target.getAttribute("task-index");m.removeTask(t)}})),a.addEventListener("click",(e=>{const n=e.target.getAttribute("task-index"),s=m.getSelectedVentureIndex();"li"===e.target.localName&&(e.target.classList.contains("checked")?(e.target.classList.remove("checked"),t.removeChecked(s,n),m.updatePage(s)):(e.target.classList.add("checked"),t.addChecked(s,n),m.updatePage(s)))})),d.addEventListener("change",(()=>{"Create New Venture"===d.value?(m.displayModal(),c.value="",c.focus(),d.value=v):m.loadVenture(d.value)})),o.addEventListener("click",(()=>{""!==c.value&&(m.addVenture(c.value),m.hideModal())})),u.addEventListener("click",(()=>m.deleteVenture())),document.addEventListener("keypress",(e=>{if("Enter"===e.key)if(console.log("enter pressed"),"none"===r.style.display)k();else{if(""===c.value)return;m.addVenture(c.value),m.hideModal()}})),document.addEventListener("keydown",(e=>{"Escape"!==e.key||"block"===r.style.display&&m.hideModal()})),i.addEventListener("click",(()=>{m.hideModal()})),document.addEventListener("DOMContentLoaded",m.loadPage())})();